(this.webpackJsonpweatherapp=this.webpackJsonpweatherapp||[]).push([[0],{66:function(e,t,r){},67:function(e,t,r){"use strict";r.r(t);var c=r(2),a=r.n(c),n=r(32),i=r.n(n),o=r(12),s=r(4),u=r(6),l=r(3),d=r.n(l),j=r(7),b=r(14),h=r.n(b),f={load:function(e){var t=localStorage.getItem(e);return JSON.parse(t)},save:function(e,t){localStorage.setItem(e,JSON.stringify(t))},remove:function(e){localStorage.removeItem(e)}};var v={getCurrentWeather:function(e){return O.apply(this,arguments)},getFiveDayForecast:function(e){return y.apply(this,arguments)}},p="0VzG5ATh98kzAmMeHPBN1FxpihPAc0Ai",m="currentWeather",x="foreCast";function O(){return(O=Object(j.a)(d.a.mark((function e(t){var r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=f.load(m)||{})[t]){e.next=5;break}if(!(Date.now()-r[t].createdAt<18e5)){e.next=5;break}return console.log("%c Got Weather from Cache ","background: #222; color: #bada55"),e.abrupt("return",r[t].data);case 5:return e.prev=5,e.next=8,h.a.get("https://dataservice.accuweather.com/currentconditions/v1/".concat(t,"?apikey=").concat(p));case 8:return c=e.sent,a=c.data[0],r[t]={data:a,createdAt:Date.now()},f.save(m,r),console.log("%c Got Weather from API ","background: #222; color: #bada55"),e.abrupt("return",a);case 16:e.prev=16,e.t0=e.catch(5),console.log("%c Failed to get Weather from API ","background: #222; color: #ff0000");case 19:case"end":return e.stop()}}),e,null,[[5,16]])})))).apply(this,arguments)}function y(){return(y=Object(j.a)(d.a.mark((function e(t){var r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=f.load(x)||[])[t]){e.next=5;break}if(!(Date.now()-r[t].createdAt<18e5)){e.next=5;break}return console.log("%c Got Forecast from Cache ","background: #222; color: #bada55"),e.abrupt("return",r[t].data);case 5:return e.prev=5,e.next=8,h.a.get("https://dataservice.accuweather.com/forecasts/v1/daily/5day/".concat(t,"?apikey=").concat(p,"&metric=",!0));case 8:return c=e.sent,a=c.data.DailyForecasts,r[t]={data:a,createdAt:Date.now()},f.save(x,r),console.log("%c Got Forecast from API ","background: #222; color: #bada55"),e.abrupt("return",a);case 16:e.prev=16,e.t0=e.catch(5),console.log("%c Failed to get Forecast from API ","background: #222; color: #ff0000");case 19:case"end":return e.stop()}}),e,null,[[5,16]])})))).apply(this,arguments)}var g={debounce:function(e,t){var r;return function(){for(var c=arguments.length,a=new Array(c),n=0;n<c;n++)a[n]=arguments[n];clearTimeout(r),r=setTimeout((function(){e.apply(void 0,a)}),t)}},getTime:function(e){var t=new Date(e);return"".concat(t.getHours(),":").concat(t.getMinutes()," \u2022 ").concat(w(t.getDay())," ").concat(t.getDate()," ").concat(function(e){switch(e){case 0:return"Jan";case 1:return"Feb";case 2:return"Mar";case 3:return"Apr";case 4:return"May";case 5:return"Jun";case 6:return"Jul";case 7:return"Aug";case 8:return"Sep";case 9:return"Oct";case 10:return"Nov";case 11:return"Dec";default:return""}}(t.getMonth())," ").concat(t.getFullYear())},getDay:function(e){return w(new Date(e).getDay())}};function w(e){switch(e){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat";default:return""}}var C=r(35),k=r(1),N=function(e){var t=e.city,r=e.removeFromFavorites,a=Object(c.useState)(null),n=Object(u.a)(a,2),i=n[0],o=n[1],l=Object(s.f)();Object(c.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getCurrentWeather(t.Key);case 2:r=e.sent,o(r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]);return i?Object(k.jsxs)("div",{className:"favorite-city-preview",onClick:function(){l.push("/city/"+t.Key)},children:[Object(k.jsx)("div",{className:"remove-from-favorite-btn",children:Object(k.jsx)(C.a,{onClick:function(e){e.stopPropagation(),r(t)}})}),Object(k.jsxs)("div",{className:"city-and-time",children:[Object(k.jsx)("div",{className:"city-name",children:t.City}),Object(k.jsx)("div",{className:"city-time",children:g.getTime(i.LocalObservationDateTime)})]}),Object(k.jsx)("img",{src:"https://www.accuweather.com/images/weathericons/".concat(i.WeatherIcon,".svg"),alt:i.WeatherText}),Object(k.jsx)("h4",{className:"weather-text",children:i.WeatherText}),Object(k.jsxs)("h4",{className:"weather-temperature",children:[i.Temperature.Metric.Value.toFixed(0),"\xb0"]})]}):null},F=r(13),A=r(19),I=function(){var e=Object(c.useState)(window.innerWidth<850),t=Object(u.a)(e,2),r=t[0],a=t[1],n=function(){var e=window.innerWidth;e<850?a(!0):e>850&&a(!1)};return Object(c.useEffect)((function(){return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[]),Object(k.jsx)("div",{className:"header",children:Object(k.jsx)("div",{className:"header-routing",children:r?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(o.b,{to:"/",children:Object(k.jsx)(A.a,{})}),Object(k.jsx)(o.b,{to:"/favorites",children:Object(k.jsx)(F.a,{})})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(o.b,{to:"/",children:Object(k.jsx)("h2",{children:"WeatherApp"})}),Object(k.jsx)(o.b,{to:"/favorites",children:Object(k.jsx)("h2",{children:"Favorites"})})]})})})},S={getCitiesNames:function(e){return M.apply(this,arguments)},getCityByGeolocation:function(){return P.apply(this,arguments)},toggleCityFavorite:function(e){var t=f.load(W)||[],r=t.findIndex((function(t){return t.Key===e.Key}));-1!==r?t.splice(r,1):t.push(e);return f.save(W,t),t},isCityFavorite:function(e){return(f.load(W)||[]).some((function(t){return t.Key===e}))},getFavoriteCities:function(){return f.load(W)||[]},getCityByKey:function(e){return K.apply(this,arguments)}},D="0VzG5ATh98kzAmMeHPBN1FxpihPAc0Ai",T="cities",W="favoriteCities";function M(){return(M=Object(j.a)(d.a.mark((function e(t){var r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=f.load(T)||{})[t]){e.next=4;break}return console.log("%c Got cities from Cache ","background: #222; color: #bada55"),e.abrupt("return",r[t].data);case 4:return e.prev=4,e.next=7,h.a.get("https://dataservice.accuweather.com/locations/v1/cities/autocomplete?apikey=".concat(D,"&q=").concat(t));case 7:return c=e.sent,a=c.data.map((function(e){return{Key:e.Key,City:e.LocalizedName,Country:e.Country.LocalizedName}})),r[t]={data:a,createdAt:Date.now()},f.save(T,r),console.log("%c Got cities from API ","background: #222; color: #bada55"),e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(4),console.log("%c Failed to get Cities from API ","background: #222; color: #ff0000");case 18:case"end":return e.stop()}}),e,null,[[4,15]])})))).apply(this,arguments)}function P(){return P=Object(j.a)(d.a.mark((function e(){var t,r,c,a,n=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{lat:-1,lng:-1},r=t.lat,c=t.lng,e.prev=1,-1!==r||-1!==c){e.next=4;break}return e.abrupt("return",Promise.resolve({Key:"215854",City:"Tel Aviv",Country:"Israel"}));case 4:return e.next=6,h.a.get("https://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey=".concat(D,"&q=").concat(r,"%2C%20").concat(c));case 6:return a=e.sent,console.log("%c Got City from API ","background: #222; color: #bada55"),e.abrupt("return",{Key:a.data.Key,City:a.data.LocalizedName,Country:a.data.Country.LocalizedName});case 11:return e.prev=11,e.t0=e.catch(1),console.log("%c Failed to get City from API ","background: #222; color: #ff0000"),e.abrupt("return",Promise.resolve({Key:"215854",City:"Tel Aviv",Country:"Israel"}));case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),P.apply(this,arguments)}function K(){return(K=Object(j.a)(d.a.mark((function e(t){var r,c,a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=f.load(T)||[],e.t0=d.a.keys(r);case 2:if((e.t1=e.t0()).done){e.next=9;break}if(c=e.t1.value,a=r[c].data.findIndex((function(e){return e.Key===t})),-1===a){e.next=7;break}return e.abrupt("return",Promise.resolve(r[c].data[a]));case 7:e.next=2;break;case 9:return e.prev=9,e.next=12,h.a.get("https://dataservice.accuweather.com/locations/v1/".concat(t,"?apikey=").concat(D));case 12:return n=e.sent,console.log("%c Got City from API ","background: #222; color: #bada55"),e.abrupt("return",n);case 17:e.prev=17,e.t2=e.catch(9),console.log("%c Failed to get City from API ","background: #222; color: #ff0000");case 20:case"end":return e.stop()}}),e,null,[[9,17]])})))).apply(this,arguments)}var z=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),r=t[0],a=t[1];Object(c.useEffect)((function(){var e=S.getFavoriteCities();a(e)}),[]);var n=function(e){var t=S.toggleCityFavorite(e);a(t)};return Object(k.jsx)("div",{className:"app",children:Object(k.jsxs)("div",{className:"main-app",children:[Object(k.jsx)(I,{}),Object(k.jsx)("div",{className:"favorite-cities-list",children:r.map((function(e){return Object(k.jsx)(N,{city:e,removeFromFavorites:n},"favorite-"+e.Key)}))})]})})},E=function(e){var t=e.onSetCitySearch,r=e.inputRef,c=g.debounce((function(e){t(e)}),500);return Object(k.jsx)("div",{className:"city-search",children:Object(k.jsx)("input",{ref:r,className:"city-input",type:"text",placeholder:"Search",onChange:function(e){c(e.target.value)}})})},G=Object(c.createContext)(null),L=function(e){var t=e.city,r=Object(c.useState)(null),a=Object(u.a)(r,2),n=a[0],i=a[1],o=Object(c.useContext)(G).todayWeather;return Object(c.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getFiveDayForecast(t);case 2:r=e.sent,console.log("foreCast",r),i(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t&&e(t.Key)}),[t]),t&&n?Object(k.jsx)("div",{className:"five-day-forecast",children:n.map((function(e){return Object(k.jsxs)("div",{className:"forecast-day",children:[Object(k.jsx)("h4",{children:g.getDay(e.Date)}),Object(k.jsx)("img",{src:"https://www.accuweather.com/images/weathericons/".concat(o.IsDayTime?e.Day.Icon:e.Night.Icon,".svg"),alt:o.IsDayTime?e.Day.IconPhrase:e.Night.IconPhrase}),Object(k.jsx)("h3",{children:o.IsDayTime?e.Day.IconPhrase:e.Night.IconPhrase}),Object(k.jsx)("h3",{children:"".concat(e.Temperature.Minimum.Value.toFixed(0),"\xb0 / ").concat(e.Temperature.Maximum.Value.toFixed(0),"\xb0")})]},t.Key+e.EpochDate)}))}):null},B=r(36),J=function(e){var t=e.isMobileMenu,r=e.toggleMobileMenu,a=Object(c.useState)(window.innerWidth<850),n=Object(u.a)(a,2),i=n[0],s=n[1],l=Object(c.useContext)(G).currentCity,d=Object(c.useState)(!1),j=Object(u.a)(d,2),b=j[0],h=j[1],f=function(){var e=window.innerWidth;e<850?s(!0):e>850&&s(!1)};Object(c.useEffect)((function(){return window.addEventListener("resize",f),l&&h(S.isCityFavorite(l.Key)),function(){window.removeEventListener("resize",f)}}),[l]);var v=function(){l&&(S.toggleCityFavorite(l),h((function(e){return!e})))};return Object(k.jsxs)("div",{className:"header",children:[Object(k.jsx)("div",{className:"header-routing",children:i?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(o.b,{to:"/",children:Object(k.jsx)(A.a,{})}),Object(k.jsx)(o.b,{to:"/favorites",children:Object(k.jsx)(F.a,{})})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(o.b,{to:"/",children:Object(k.jsx)("h2",{children:"WeatherApp"})}),Object(k.jsx)(o.b,{to:"/favorites",children:Object(k.jsx)("h2",{children:"Favorites"})})]})}),i?Object(k.jsx)(B.a,{className:"mobile-hamburger-btn",onClick:function(){r(!t)}}):Object(k.jsx)("div",{className:"header-favorite-sate",children:b?Object(k.jsx)(F.a,{onClick:v}):Object(k.jsx)(F.b,{onClick:v})})]})},V=function(e){var t=e.cities,r=e.setCurrentCity,c=e.toggleMobileMenu,a=e.clearSearch;return Object(k.jsx)("div",{className:"cities-list ".concat(t&&t.length>0?"show":""),children:Object(k.jsx)("ul",{children:t&&t.length>0&&t.map((function(e){return Object(k.jsxs)("li",{onClick:function(){!function(e){r(e),c(!1),a()}(e)},className:"city-item",children:[e.City,", ",e.Country]},"item-".concat(e.Key))}))})})},H=function(e){var t=e.city,r=Object(c.useContext)(G),a=r.todayWeather,n=r.setTodayWeather,i=Object(c.useState)(!1),o=Object(u.a)(i,2),s=o[0],l=o[1];Object(c.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getCurrentWeather(t);case 2:r=e.sent,n(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t&&(e(t.Key),l(S.isCityFavorite(t.Key)))}),[t,n]);var b=function(){t&&(S.toggleCityFavorite(t),l((function(e){return!e})))};return console.log("currentWeather from context",a),t&&a?Object(k.jsxs)("div",{className:"todays-weather",children:[Object(k.jsx)("div",{className:"city-favorite-state",children:s?Object(k.jsx)(F.a,{onClick:b}):Object(k.jsx)(F.b,{onClick:b})}),Object(k.jsxs)("div",{className:"temp-display",children:[a.Temperature.Metric.Value.toFixed(0),"\xb0"]}),Object(k.jsxs)("div",{className:"city-and-time",children:[Object(k.jsx)("div",{className:"city-name",children:t.City}),Object(k.jsx)("div",{className:"city-time",children:g.getTime(a.LocalObservationDateTime)})]}),Object(k.jsxs)("div",{className:"weather-preview",children:[Object(k.jsx)("img",{src:"https://www.accuweather.com/images/weathericons/".concat(a.WeatherIcon,".svg"),alt:a.WeatherText}),Object(k.jsx)("p",{children:a.WeatherText})]})]}):null},R=function(e){var t=e.isOpen,r=e.exitScreen;return Object(k.jsx)("div",{onClick:function(){r(!1)},className:"screen ".concat(t?"screen-active":"")})},q=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),r=t[0],a=t[1],n=Object(c.useState)(null),i=Object(u.a)(n,2),o=i[0],l=i[1],b=Object(c.useState)(null),h=Object(u.a)(b,2),f=h[0],v=h[1],p=Object(c.useState)(!1),m=Object(u.a)(p,2),x=m[0],O=m[1],y=Object(c.useRef)(null),g=Object(s.g)();Object(c.useEffect)((function(){var e=function(){var e=Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getCityByKey(g.citykey);case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();g&&0!==Object.keys(g).length?e():navigator.geolocation.getCurrentPosition(function(){var e=Object(j.a)(d.a.mark((function e(t){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={lat:t.coords.latitude,lng:t.coords.longitude},e.next=3,S.getCityByGeolocation(r);case 3:c=e.sent,l(c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getCityByGeolocation();case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)}))))}),[]);var w=function(){var e=Object(j.a)(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getCitiesNames(t);case 2:r=e.sent,a(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){O(e)};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{className:"app",children:Object(k.jsxs)(G.Provider,{value:{todayWeather:f,setTodayWeather:v,currentCity:o},children:[Object(k.jsxs)("div",{className:"main-app",children:[Object(k.jsx)(J,{isMobileMenu:x,toggleMobileMenu:C}),Object(k.jsxs)("div",{className:"weather-details-zone",children:[Object(k.jsx)(H,{city:o}),Object(k.jsx)(L,{city:o})]})]}),Object(k.jsxs)("div",{className:"search-details-zone ".concat(x?"show-menu":""),children:[Object(k.jsx)(E,{inputRef:y,onSetCitySearch:function(e){w(e)}}),Object(k.jsx)(V,{cities:r,setCurrentCity:l,toggleMobileMenu:C,clearSearch:function(){a([]),y.current&&(y.current.value="")}})]})]})}),Object(k.jsx)(R,{isOpen:x,exitScreen:C})]})};var Y=function(){return Object(k.jsx)(o.a,{children:Object(k.jsxs)(s.c,{children:[Object(k.jsx)(s.a,{exact:!0,path:"/favorites",component:z}),Object(k.jsx)(s.a,{path:"/city/:citykey",component:q}),Object(k.jsx)(s.a,{exact:!0,path:"/",component:q})]})})};r(66);i.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(Y,{})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.6ff8d3af.chunk.js.map